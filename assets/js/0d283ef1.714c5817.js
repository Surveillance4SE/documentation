"use strict";(self.webpackChunkes_documentation=self.webpackChunkes_documentation||[]).push([[835],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),c=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},u=function(e){var t=c(e.components);return i.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(n),m=a,f=d["".concat(l,".").concat(m)]||d[m]||p[m]||o;return n?i.createElement(f,r(r({ref:t},u),{},{components:n})):i.createElement(f,r({ref:t},u))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,r=new Array(o);r[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,r[1]=s;for(var c=2;c<o;c++)r[c]=n[c];return i.createElement.apply(null,r)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},4768:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var i=n(7462),a=(n(7294),n(3905));const o={sidebar_position:5},r="Notification Module",s={unversionedId:"architecture/notification_module",id:"architecture/notification_module",title:"Notification Module",description:"This module is responsible for handling all notification requests. It's subscribed to notifications requests queue and whenever a message arrives at this given topic, the module will consume the message and proceed to send notifications to a certain list of users/officers through their preferencial method of receiving the notifications.",source:"@site/docs/architecture/notification_module.md",sourceDirName:"architecture",slug:"/architecture/notification_module",permalink:"/documentation/docs/architecture/notification_module",draft:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Health Checks",permalink:"/documentation/docs/architecture/health_check"},next:{title:"Management Frontend",permalink:"/documentation/docs/architecture/management_frontend"}},l={},c=[{value:"V1",id:"v1",level:2},{value:"V2",id:"v2",level:2},{value:"V3",id:"v3",level:2},{value:"Dependencies",id:"dependencies",level:2}],u={toc:c};function p(e){let{components:t,...o}=e;return(0,a.kt)("wrapper",(0,i.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"notification-module"},"Notification Module"),(0,a.kt)("p",null,"This module is responsible for handling all notification requests. It's subscribed to notifications requests queue and whenever a message arrives at this given topic, the module will consume the message and proceed to send notifications to a certain list of users/officers through their preferencial method of receiving the notifications."),(0,a.kt)("p",null,"Notification logic is being controlled by the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/Surveillance4SE/ima"},"Intrusion-Management-Api")," service."),(0,a.kt)("h2",{id:"v1"},"V1"),(0,a.kt)("p",null,"The initial phase of this module was implemented as lambda functions but due to conflits, it was decommissioned."),(0,a.kt)("h2",{id:"v2"},"V2"),(0,a.kt)("p",null,"What we thought to be the final version, instead it turned out to be another step on the evolution of the module.\nIn this version, an actual REST API using FastApi was built."),(0,a.kt)("p",null,"It was discontinued because it made more sense to make it using RabbitMQ messages."),(0,a.kt)("h2",{id:"v3"},"V3"),(0,a.kt)("p",null,"In this final version, the service is implemented in an ECS image, configured for scalability."),(0,a.kt)("p",null,"Here, the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/Surveillance4SE/ima"},"Intrusion-Management-Api")," triggers the Notification Module once an intrusion is detected for it to send the adequate notifiactions for the right users."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"diagram",src:n(4734).Z,width:"601",height:"344"})),(0,a.kt)("p",null,"Upon consuming the message from the broker, the Notification Module will start processing it by parsing the information."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"{\n    camera_id: 1,\n    intrusion_timestamp: 1671051238317,\n    intrusion_id: 139\n}\n")),(0,a.kt)("p",null,"It will make use of ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/Surveillance4SE/notification-module/blob/dev/src/management_api.py"},"ManagementApi")," to fetch the user/officer lists containing the people that should be notified and also their notification preference.",(0,a.kt)("br",{parentName:"p"}),"\n","With that, for each person in that list, it will make a call to AWS Cognito Identity Provider service on ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/Surveillance4SE/notification-module/blob/dev/src/idp_connection.py"},"IdpConnection")," to get all the information necessary linked to that person.",(0,a.kt)("br",{parentName:"p"}),"\n","After that, it will call ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/Surveillance4SE/notification-module/blob/dev/src/notification_manager.py"},"NotificationManager")," to assign the notification preference to the correct script call.",(0,a.kt)("br",{parentName:"p"}),"\n","The notifications itself are all processed using Twilio for Whatsapp, Sms and Call and for Email it's using AWS Simple Email Service."),(0,a.kt)("h2",{id:"dependencies"},"Dependencies"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"MySql Database")," - Access is needed in order to send detailed information regarding the notification."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/Surveillance4SE/Management-Web-API"},"Management-Web-Api")," - controls notification details information."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Rabbit MQ server")," - notification frames are exchanged using the RabbitMQ broker server.")))}p.isMDXComponent=!0},4734:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/diagram-4e52f5a6da51ebb2817daa8fa017471d.png"}}]);